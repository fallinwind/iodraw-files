{"root":{"data":{"text":"LangChain框架下DeepSeek模型接入测试方案（线上API vs 本地Ollama双路径验证）"},"children":[{"data":{"text":"测试目标"},"children":[{"data":{"text":"验证LangChain对DeepSeek模型的兼容性与调用稳定性"},"children":[]},{"data":{"text":"对比线上API模式（deepseek.com）与本地Ollama模式在延迟、成本、隐私、可控性维度的表现"},"children":[]},{"data":{"text":"建立可复现、可文档化的端到端测试流程，支持团队快速落地"},"children":[]},{"data":{"text":"明确不同场景下的技术选型建议（POC验证 / 内网部署 / 生产级服务）"},"children":[]}]},{"data":{"text":"线上API模式说明"},"children":[{"data":{"text":"技术原理"},"children":[{"data":{"text":"通过LangChain ChatDeepSeek 或 ChatOpenAI 兼容封装调用 DeepSeek 官方 REST API"},"children":[]},{"data":{"text":"依赖 https://api.deepseek.com/v1/chat/completions 接口，需有效 API Key（最低充值1元开通）"},"children":[]}]},{"data":{"text":"实施步骤"},"children":[{"data":{"text":"注册 deepseek.com 账号 → 进入 API控制台 创建 API Key"},"children":[]},{"data":{"text":"设置环境变量：DEEPSEEK_API_KEY=sk-xxx（避免硬编码）"},"children":[]}]},{"data":{"text":"关键配置项"},"children":[{"data":{"text":"model: \"deepseek-chat\"（R1主模型）、\"deepseek-coder\"（代码专用）"},"children":[]},{"data":{"text":"认证方式：Bearer Token（Authorization: Bearer sk-xxx）"},"children":[]}]}]},{"data":{"text":"线下模式说明"},"children":[{"data":{"text":"技术原理"},"children":[{"data":{"text":"模型运行完全离线，所有推理、tokenization、embedding 均在本地完成"},"children":[]},{"data":{"text":"支持 DeepSeek-R1 系列量化模型（1.5b/7b/8b/14b），推荐 7b 版本兼顾性能与显存"},"children":[]}]},{"data":{"text":"实施步骤"},"children":[{"data":{"text":"下载安装 Ollama：https://ollama.com/download"},"children":[]},{"data":{"text":"拉取模型（首次约5–8GB，需稳定网络）"},"children":[]},{"data":{"text":"启动 Ollama 服务（默认监听 127.0.0.1:11434）"},"children":[]}]},{"data":{"text":"关键配置项"},"children":[{"data":{"text":"base_url: \"http://localhost:11434\""},"children":[]},{"data":{"text":"model: \"deepseek-r1:7b\""},"children":[]},{"data":{"text":"num_predict: 控制最大输出长度（Ollama 特有参数）"},"children":[]},{"data":{"text":"远程访问配置（跨设备调用）"},"children":[{"data":{"text":"启动时指定绑定地址：OLLAMA_HOST=0.0.0.0:11434 ollama serve"},"children":[]},{"data":{"text":"防火墙放行 11434 端口"},"children":[]},{"data":{"text":"LangChain 中 base_url 改为 http://<host-ip>:11434"},"children":[]}]}]}]},{"data":{"text":"测试结果对比"},"children":[{"data":{"text":"稳定性与运维"},"children":[{"data":{"text":"线上API"},"children":[{"data":{"text":"优势：免运维、高可用SLA（99.9%）"},"children":[]},{"data":{"text":"风险：依赖公网、政策风险"},"children":[]}]},{"data":{"text":"本地Ollama"},"children":[{"data":{"text":"优势：离线、数据零外泄、可定制"},"children":[]},{"data":{"text":"风险：需维护模型与GPU兼容性、OOM崩溃需重启"},"children":[]}]}]}]},{"data":{"text":"适用场景决策指南"},"children":[{"data":{"text":"推荐线上API模式的场景"},"children":[{"data":{"text":"快速原型验证（MVP开发周期 < 3天）"},"children":[]},{"data":{"text":"无GPU/低配环境（MacBook Air M1/M2）"},"children":[]},{"data":{"text":"临时高并发需求（如Demo路演）"},"children":[]},{"data":{"text":"需要最新模型能力（deepseek-coder-v2）"},"children":[]}]},{"data":{"text":"推荐本地Ollama模式的场景"},"children":[{"data":{"text":"企业内网/政务专网（GDPR、等保三级）"},"children":[]},{"data":{"text":"敏感数据处理（合同、病历、财报）"},"children":[]},{"data":{"text":"长期高频调用（月调用量 > 50万次）"},"children":[]},{"data":{"text":"需要微调或LoRA适配"},"children":[]}]},{"data":{"text":"混合部署建议（进阶实践）"},"children":[{"data":{"text":"开发/测试环境：本地Ollama"},"children":[]},{"data":{"text":"预发布环境：线上API"},"children":[]},{"data":{"text":"生产环境：数据敏感性分级"},"children":[{"data":{"text":"公共问答类：线上API（CDN缓存）"},"children":[]},{"data":{"text":"知识库类：本地Ollama集群（K8s编排）"},"children":[]}]},{"data":{"text":"统一LangChain抽象层：os.getenv(\"LLM_MODE\")切换实例"},"children":[]}]}]},{"data":{"text":"附：常见问题与解决方案"},"children":[{"data":{"text":"Q：Ollama无法访问 localhost:11434？"},"children":[{"data":{"text":"A：检查防火墙、端口占用、清除缓存目录"},"children":[]}]},{"data":{"text":"Q：LangChain调用Ollama报错 “model not found”？"},"children":[{"data":{"text":"A：检查模型名称与tag大小写一致"},"children":[]}]},{"data":{"text":"Q：线上API返回400“invalid_request_error”？"},"children":[{"data":{"text":"A：确认 messages 格式与 model 参数正确"},"children":[]}]},{"data":{"text":"Q：如何让Ollama更符合中文习惯？"},"children":[{"data":{"text":"A：添加 system_message 或自定义 Modelfile"},"children":[]}]},{"data":{"text":"Q：能否加载DeepSeek-R1-671B？"},"children":[{"data":{"text":"A：不推荐，需 >1TB内存，仅建议使用≤14B模型"},"children":[]}]}]}]},"template":"right","theme":"fresh-blue","version":"1.4.43"}